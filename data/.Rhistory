demo()
install.packages("rmarkdown")
install.packages("tidyr")
install.packages("dplyr")
install.packages("ggplot2")
installed.packages()
df<-read.table("bandit1-trials.tsv",header=T)
install.package(MASS)
install.packages(MASS)
help
help(aov)
help(sample)
help subset
help(subset)
help(to)
source("C:/Users/Davis/Downloads/Ranalysis-master/Ranalysis-master/useful.R")
setwd("D:/Git/Self-reported-Probability-matching/data")
library(MASS)
source("C:/Users/Davis/Downloads/Ranalysis-master/Ranalysis-master/useful.R")
#setwd("../data/")
setwd("D:/Git/Self-reported-Probability-matching/data")
df<-read.table('bandit1-trials.tsv',header=T,stringsAsFactors=FALSE)
#trimming the df table to exclude the prevalence answers
trim<-subset(df, trial_type=="multi_trial")
#new column with timeouts registered as Incorrect
trim$rs_timeOutWrong<-trim$result
trim[which(trim$result==-1),]$rs_timeOutWrong<-0
#new column indicating correct bias-matching
trim$bias_match<-ifelse(trim$response==trim$bias_direction,1,0)
#aggregating over subjects - currently not used
subj_aggr <- ddply(trim, .(workerid), summarise,
bias=sample(bias,1),
bias_direction=sample(bias_direction,1),
rt=mean(rt),
rs_acc=mean(rs_timeOutWrong),
match_acc=mean(bias_match))
#forming cumulative metrics for each subject
score_aggr<-ddply(trim, .(workerid), mutate,
relative_prop = cumsum(bias_match)/to.n(trial),
trial=to.n(trial),
relative_left = cumsum(response=='L')/to.n(trial),
bias = factor(bias),
Lbias = factor(Lbias),
biasDir = factor(bias_direction))
#forming cumulative metrics for each trial
trial_aggr<-ddply(trim, .(trial,bias), summarise,
no_correct = sum(bias_match),
no_total = length(unique(workerid)))
trial_aggr$trial_no<-to.n(trial_aggr$trial)
trial_aggr$subj_proportion<-trial_aggr$no_correct/trial_aggr$no_total
trial_aggr<-trial_aggr[order(trial_aggr$bias,trial_aggr$trial_no),]
trial_aggr<-mutate(group_by(trial_aggr,bias), aggr_acc=cumsum(subj_proportion)/trial_no)
rs<-lm(data=subj_aggr[which(subj_aggr$bias=="60"),], rt ~ match_acc)
summary(rs)
rs<-lm(data=subj_aggr[which(subj_aggr$bias=="60"),], match_acc ~ rt)
summary(rs)
rs<-glm(data=subj_prev, factor(catch_score) ~ off_by, family='binomial')
summary(rs)
rs<-glm(data=subj_prev, factor(catch_score) ~ off_by, family='binomial')
prev<-df[which(df$trial_type=="elicit_prevalence"), c('workerid', 'rt', 'Lbias', 'trial', 'response')]
score1<-prev[which(prev$trial=="catch1"),]$response=="2"
score2<-prev[which(prev$trial=="catch2"),]$response=="2"
score3<-prev[which(prev$trial=="catch3"),]$response=="50"
subj_prev <- prev[which(prev$trial=="prevalence"), c('workerid', 'Lbias', 'response')]
subj_prev$catch_score <- score1+score2+score3
subj_prev$off_by <- as.numeric(subj_prev$response) - 100*subj_prev$Lbias
subj_prev$trial_acc <- subj_aggr$match_acc
#Match accuracy as a measure of reporting accuracy. Oh dear.
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(-75,75)+
geom_smooth(method=lm)
#It rather seems that catch score is a better measure of reporting accuracy
ggplot(subj_prev, aes(x=factor(catch_score), y=off_by, fill=catch_score))+
geom_boxplot()+
ylim(-75,75)+
guides(fill=FALSE)
#But not significantly
rs<-glm(data=subj_prev, factor(catch_score) ~ off_by, family='binomial')
summary(rs)
ggplot(subj_prev[which(catch_score >= 2),], aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(-75,75)+
geom_smooth(method=lm)
ggplot(subj_prev[which(subj_prev$catch_score >= 2),], aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(-75,75)+
geom_smooth(method=lm)
ggplot(subj_prev[which(subj_prev$catch_score >= 3),], aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(-75,75)+
geom_smooth(method=lm)
ggplot(subj_prev[which(subj_prev$catch_score == 3),], aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(-75,75)+
geom_smooth(method=lm)
ggplot(subj_prev[which(subj_prev$catch_score == 2),], aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(-75,75)+
geom_smooth(method=lm)
ggplot(subj_prev[which(subj_prev$catch_score == 1),], aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(-75,75)+
geom_smooth(method=lm)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(-75,75)+
geom_smooth(method=lm)+
facet_wrap(~catch_score)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(-75,75)+
geom_smooth(method=lm)+
facet_wrap(~bias)
prev<-df[which(df$trial_type=="elicit_prevalence"), c('workerid', 'rt', 'Lbias', 'bias', 'trial', 'response')]
score1<-prev[which(prev$trial=="catch1"),]$response=="2"
score2<-prev[which(prev$trial=="catch2"),]$response=="2"
score3<-prev[which(prev$trial=="catch3"),]$response=="50"
subj_prev <- prev[which(prev$trial=="prevalence"), c('workerid', 'Lbias', 'response')]
subj_prev$catch_score <- score1+score2+score3
subj_prev$off_by <- as.numeric(subj_prev$response) - 100*subj_prev$Lbias
subj_prev$trial_acc <- subj_aggr$match_acc
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(-75,75)+
geom_smooth(method=lm)+
facet_wrap(~bias)
subj_prev <- prev[which(prev$trial=="prevalence"), c('workerid', 'Lbias', 'bias', 'response')]
subj_prev$catch_score <- score1+score2+score3
subj_prev$off_by <- as.numeric(subj_prev$response) - 100*subj_prev$Lbias
subj_prev$trial_acc <- subj_aggr$match_acc
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(-75,75)+
geom_smooth(method=lm)+
facet_wrap(~bias)
subj_prev$off_by <- abs(as.numeric(subj_prev$response) - 100*subj_prev$Lbias)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(-75,75)+
geom_smooth(method=lm)
ggplot(subj_prev, aes(x=factor(catch_score), y=off_by, fill=catch_score))+
geom_boxplot()+
ylim(-75,75)+
guides(fill=FALSE)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(-75,75)+
geom_smooth(method=lm)+
facet_wrap(~catch_score)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(-75,75)+
geom_smooth(method=lm)+
facet_wrap(~bias)
ggplot(subj_prev, aes(x=factor(catch_score), y=off_by, fill=catch_score))+
geom_boxplot()+
guides(fill=FALSE)
#But not significantly
#Match accuracy as a measure of reporting accuracy. Oh dear.
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(-75,75)+
geom_smooth(method=lm)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
geom_smooth(method=lm)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(0,100)+
geom_smooth(method=lm)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(,100)+
geom_smooth(method=lm)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
ylim(100)+
geom_smooth(method=lm)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
geom_smooth(method=lm)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
geom_smooth(method=lm)+
facet_wrap(~catch_score)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
geom_smooth(method=lm)+
facet_wrap(~catch_score, scales='free')
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
geom_smooth(method=lm)+
facet_wrap(~bias)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
geom_smooth(method=lm)+
facet_wrap(~catch_score)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
geom_smooth(method=lm)+
facet_wrap(~catch_score, scales='free')
ggplot(trial_aggr, aes(x=trial_no,y=aggr_acc))+
geom_line(size=1)+
ylim(0,1)+
ylab("Bias Accuracy")+
facet_wrap(~bias)+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1))
ggplot(trial_aggr, aes(x=trial_no,y=aggr_acc))+
geom_line(size=1)+
ylim(0,1)+
ylab("Bias Accuracy")+
facet_wrap(~bias)+
scale_y_discrete(breaks=c(0,0.2,0.4,0.6,0.8,1))
ggplot(trial_aggr, aes(x=trial_no,y=aggr_acc))+
geom_line(size=1)+
ylim(0,1)+
ylab("Bias Accuracy")+
facet_wrap(~bias)+
scale_y_continuous(c(0,0.2,0.4,0.6,0.8,1))
ggplot(trial_aggr, aes(x=trial_no,y=aggr_acc))+
geom_line(size=1)+
ylim(0,1)+
ylab("Bias Accuracy")+
facet_wrap(~bias)+
scale_y_continuous(0,0.2,0.4,0.6,0.8,1)
ggplot(trial_aggr, aes(x=trial_no,y=aggr_acc))+
geom_line(size=1)+
ylim(0,1)+
ylab("Bias Accuracy")+
facet_wrap(~bias)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
geom_smooth(method=lm)+
facet_wrap(~catch_score, scales='free')+
xlim(-100,100)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
geom_smooth(method=lm)+
facet_wrap(~catch_score, scales='free')
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
geom_smooth(method=lm)+
facet_wrap(~bias)+
ylim(-100,100)
ggplot(subj_prev, aes(x=trial_acc,y=off_by))+
geom_point(shape=1)+
geom_smooth(method=lm)+
facet_wrap(~catch_score, scales='free')+
ylim(-100,100)
