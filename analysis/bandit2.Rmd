---
title: "bandit2"
author: "Davis Wertheimer"
date: "February 4, 2014"
output: html_document
---

```{r, echo=FALSE, message=FALSE}
library(tidyr)
library(dplyr)
library(ggplot2)
library(plyr)
library(MASS)
```

Herein lies the analysis for the first experiment of the bandit elicitation paradigm.


Initial variables and declarations
=
```{r}
setwd("../data/")
df<-read.table('bandit1-trials.tsv',header=T)
trim<-subset(df, trial_type=="multi_trial")
df8<-subset(trim, bias==80)
df6<-subset(trim, bias==60)
subj_aggregate <- ddply(trim, c("workerid"), summarise, bias=sample(bias,1), bias_direction=sample(bias_direction,1), rt=mean(rt), acc=mean(result))
```

Some basic tables:
=
```{r}
#Effect of bias level on performance
ddply(trim, c("bias"), summarise, N = length(unique(workerid)), rt = mean(rt), acc = mean(result))
#Bias level has no significant effect on reaction times
attach(subj_aggregate)
summary(aov(rt ~ bias))

#Effect of bias direction on performance, across levels. 
ddply(trim, c("bias", "bias_direction"), summarise, N = length(unique(workerid)), rt = mean(rt), acc = mean(result))
#Effect of bias direction is not significant for accuracy...
summary(aov(acc ~ bias_direction))
#...or reaction time
summary(aov(rt ~ bias_direction))

#This is odd. Two of the subjects didn't go through all 50 trials... is this NA correction?
subset(ddply(df, c("workerid"), summarise, N = length(rt)), N!=54)

```

Correlations:
=
```{r}
#Trial # with rt
#rt with result
#trial # with result
```

Basic plots:
=
```{r}
 ggplot(data=trim,aes(x=rt))+geom_histogram(alpha=0.6)
 
# df0<-ddply(subset(df,trial_type=='multi_trial'), 
#       .(workerid), summarise, 
#       relative_prop = cumsum(result)/to.n(trial), trial=to.n(trial),
#       relative_left = cumsum(response=='L')/to.n(trial), 
#       Lbias = factor(Lbias_.),
#       biasDir = factor(bias_direction))
# 
# ggplot(df0, aes(x=trial,y=relative_prop,group=workerid,color=workerid))+
#   geom_line(size=1)+
#   ylab("relative proportion correct")+
#   facet_wrap(~Lbias)+
#   guides(color=F)
# 
# ggplot(df0, aes(x=trial, y=relative_left, group=workerid,color=workerid))+
#   geom_line(size=1)+
#   ylab("relative L responses")+
#   facet_wrap(~Lbias)+
#   guides(color=F)

```
